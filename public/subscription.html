<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="description" content="Explore ShelfShare's subscription plans to enhance your reading experience.">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <title>ShelfShare | Subscription Plans</title>
        <link rel="icon" type="image/x-icon" href="../icon.png">
        <link rel="stylesheet" href="../style.css"/>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
        <style>
            .content {
                padding: 20px 20% 50px 20%;
                text-align: justify;
                line-height: 1.6;
            }
            .content img {
                width: 60%;
                max-width: 500px;
                margin: 0px auto 40px auto;
                border-radius: 10px;
            }
            
            h1 {
                padding-top: 50px;
                padding-bottom: 20px;
                text-align: center;
            }
            h3 {
                text-align: center;
            }

            @media (max-width: 600px) {
                .content {
                    padding: 20px 50px 20px 50px;
                }
            }
        </style>

        <!-- Header -->
        <script src="../header.js"></script>
    </head>

    <body>
        <h1>Coming Soon: Subscription Plans</h1>

    <div class="content">
        <h2>Select Your Subscription</h2>
        <form id="subscriptionForm">
            <input type="radio" name="plan" value="Basic Plan" id="basic" required>
            <label for="basic">Basic Plan - $5/month</label><br>
            <input type="radio" name="plan" value="Premium Plan" id="premium">
            <label for="premium">Premium Plan - $12/month</label><br>
            <input type="radio" name="plan" value="Family Plan" id="family">
            <label for="family">Family Plan - $25/month</label><br>
            <button type="submit">Subscribe</button>
        </form>
    </div>
    
    <script>
    document.getElementById('subscriptionForm').addEventListener('submit', async function (event) {
        event.preventDefault();
        const plan = document.querySelector('input[name="plan"]:checked').value;
    
        const currentUser = JSON.parse(localStorage.getItem('currentUser'));
        if (!currentUser) {
            alert('You must be logged in to subscribe.');
            return;
        }
    
        try {
            const response = await fetch('/subscribe', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ username: currentUser.username, subscription: plan }),
            });
    
            if (response.ok) {
                alert('Subscription updated successfully.');
                currentUser.subscription = plan;
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
            } else {
                alert('Failed to update subscription.');
            }
        } catch (error) {
            console.error('Error:', error);
        }
    });
    </script>


        <!-- Footer -->
        <script src="../footer.js"></script>
    </body>
</html>
